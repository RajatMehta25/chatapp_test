(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{136:function(e,a,t){},137:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(31),o=t.n(c),m=(t(63),t(64),t(57)),l=(t(65),t(8)),s=t(16),u=t(18),i=t(17),f=t(11),p=t(138),d=t(139),E=t(140),b=t(141),v=t(142),h=t(143),g=t(144),k=t(37),j=t.n(k);j.a.initializeApp({projectId:"chat-app-d374a",apiKey:"AIzaSyAqqUNxzj7wvT3U1d-oYPQdcKN0XBCNHy8",databaseURL:"https://chat-app-d374a-default-rtdb.firebaseio.com"});var y=j.a;var O=function(){var e=Object(l.g)(),a=Object(n.useState)({nickname:""}),t=Object(f.a)(a,2),c=t[0],o=t[1],m=Object(n.useState)(!1),s=Object(f.a)(m,2),k=s[0],j=s[1],O=y.database().ref("users/");return r.a.createElement("div",null,k&&r.a.createElement(p.a,{color:"primary"}),r.a.createElement(d.a,null,r.a.createElement(E.a,{onSubmit:function(a){a.preventDefault(),j(!0),O.orderByChild("nickname").equalTo(c.nickname).once("value",(function(a){a.exists()?(localStorage.setItem("nickname",c.nickname),e.push("/roomlist"),j(!1)):(y.database().ref("users/").push().set(c),localStorage.setItem("nickname",c.nickname),e.push("/roomlist"),j(!1))}))}},r.a.createElement(b.a,null,r.a.createElement(v.a,null,"Nickname"),r.a.createElement(h.a,{type:"text",name:"nickname",id:"nickname",placeholder:"Enter Your Nickname",value:c.nickname,onChange:function(e){e.persist(),o(Object(i.a)(Object(i.a)({},c),{},Object(u.a)({},e.target.name,e.target.value)))}})),r.a.createElement(g.a,{variant:"primary",type:"submit"},"Login"))))},S=t(21),C=t.n(S),N=t(28),x=t(145),D=t(146),Y=t(29),w=t.n(Y);var B=function(){var e=Object(n.useState)([]),a=Object(f.a)(e,2),t=a[0],c=a[1],o=Object(n.useState)(!0),m=Object(f.a)(o,2),u=m[0],i=m[1],E=Object(n.useState)(""),b=Object(f.a)(E,2),v=b[0],h=b[1],k=Object(l.g)();Object(n.useEffect)((function(){(function(){var e=Object(N.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(localStorage.getItem("nickname")),y.database().ref("rooms/").on("value",(function(e){c([]),c(j(e)),i(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var j=function(e){var a=[];return e.forEach((function(e){var t=e.val();t.key=e.key,a.push(t)})),a};return r.a.createElement("div",null,u&&r.a.createElement(p.a,{color:"primary"}),r.a.createElement(d.a,null,r.a.createElement("h3",null,v," ",r.a.createElement(g.a,{onClick:function(){localStorage.removeItem("nickname"),k.push("/login")}},"Logout")),r.a.createElement("h2",null,"Room List"),r.a.createElement("div",null,r.a.createElement(s.b,{to:"/addroom"},"Add Room")),r.a.createElement(x.a,null,t.map((function(e,a){return r.a.createElement(D.a,{key:a,action:!0,onClick:function(){!function(e){var a={roomname:"",nickname:"",message:"",date:"",type:""};a.roomname=e,a.nickname=v,a.date=w()(new Date).format("DD/MM/YYYY HH:mm:ss"),a.message="".concat(v," enter the room"),a.type="join",y.database().ref("chats/").push().set(a),y.database().ref("roomusers/").orderByChild("roomname").equalTo(e).on("value",(function(a){var t=j(a).find((function(e){return e.nickname===v}));if(void 0!==t){y.database().ref("roomusers/"+t.key).update({status:"online"})}else{var n={roomname:"",nickname:"",status:""};n.roomname=e,n.nickname=v,n.status="online",y.database().ref("roomusers/").push().set(n)}})),k.push("/chatroom/"+e)}(e.roomname)}},e.roomname)})))))},M=t(154);var I=function(){var e=Object(l.g)(),a=Object(n.useState)({roomname:""}),t=Object(f.a)(a,2),c=t[0],o=t[1],m=Object(n.useState)(!1),s=Object(f.a)(m,2),k=s[0],j=s[1],O=y.database().ref("rooms/");return r.a.createElement("div",null,k&&r.a.createElement(p.a,{color:"primary"}),r.a.createElement(d.a,null,r.a.createElement("h2",null,"Please enter new Room"),r.a.createElement(E.a,{onSubmit:function(a){a.preventDefault(),j(!0),O.orderByChild("roomname").equalTo(c.roomname).once("value",(function(a){if(a.exists())return r.a.createElement("div",null,r.a.createElement(M.a,{color:"primary"},"Room name already exist!"));y.database().ref("rooms/").push().set(c),e.goBack(),j(!1)}))}},r.a.createElement(b.a,null,r.a.createElement(v.a,null,"Room Name"),r.a.createElement(h.a,{type:"text",name:"roomname",id:"roomname",placeholder:"Enter Room Name",value:c.roomname,onChange:function(e){e.persist(),o(Object(i.a)(Object(i.a)({},c),{},Object(u.a)({},e.target.name,e.target.value)))}})),r.a.createElement(g.a,{variant:"primary",type:"submit"},"Add"))))},q=t(147),R=t(148),T=t(149),H=t(150),A=t(151),L=t(152),U=t(153),z=t(155),F=t(56),J=t.n(F);t(136);var K=function(){var e=Object(n.useState)([]),a=Object(f.a)(e,2),t=a[0],c=a[1],o=Object(n.useState)([]),m=Object(f.a)(o,2),s=m[0],p=m[1],d=Object(n.useState)(""),b=Object(f.a)(d,2),v=b[0],k=b[1],j=Object(n.useState)(""),O=Object(f.a)(j,2),S=O[0],x=O[1],D=Object(n.useState)({roomname:"",nickname:"",message:"",date:"",type:""}),Y=Object(f.a)(D,2),B=Y[0],M=Y[1],I=Object(l.g)(),F=Object(l.i)().room;Object(n.useEffect)((function(){(function(){var e=Object(N.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(localStorage.getItem("nickname")),x(F),y.database().ref("chats/").orderByChild("roomname").equalTo(S).on("value",(function(e){c([]),c(K(e))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[F,S]),Object(n.useEffect)((function(){(function(){var e=Object(N.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(localStorage.getItem("nickname")),x(F),y.database().ref("roomusers/").orderByChild("roomname").equalTo(S).on("value",(function(e){p([]);var a=K(e);p(a.filter((function(e){return"online"===e.status})))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[F,S]);var K=function(e){var a=[];return e.forEach((function(e){var t=e.val();t.key=e.key,a.push(t)})),a};return r.a.createElement("div",{className:"Container"},r.a.createElement(q.a,null,r.a.createElement(R.a,null,r.a.createElement(T.a,{xs:"4"},r.a.createElement("div",null,r.a.createElement(H.a,{className:"UsersCard"},r.a.createElement(A.a,null,r.a.createElement(L.a,null,r.a.createElement(g.a,{variant:"primary",type:"button",onClick:function(){!function(e){var a={roomname:"",nickname:"",message:"",date:"",type:""};a.roomname=S,a.nickname=v,a.date=w()(new Date).format("DD/MM/YYYY HH:mm:ss"),a.message="".concat(v," leave the room"),a.type="exit",y.database().ref("chats/").push().set(a),y.database().ref("roomusers/").orderByChild("roomname").equalTo(S).once("value",(function(e){var a=K(e).find((function(e){return e.nickname===v}));void 0!==a&&y.database().ref("roomusers/"+a.key).update({status:"offline"})})),I.goBack()}()}},"Exit Chat")))),s.map((function(e,a){return r.a.createElement(H.a,{key:a,className:"UsersCard"},r.a.createElement(A.a,null,r.a.createElement(L.a,null,e.nickname)))})))),r.a.createElement(T.a,{xs:"8"},r.a.createElement(J.a,{className:"ChatContent"},t.map((function(e,a){return r.a.createElement("div",{key:a,className:"MessageBox"},"join"===e.type||"exit"===e.type?r.a.createElement("div",{className:"ChatStatus"},r.a.createElement("span",{className:"ChatDate"},e.date),r.a.createElement("span",{className:"ChatContentCenter"},e.message)):r.a.createElement("div",{className:"ChatMessage"},r.a.createElement("div",{className:"".concat(e.nickname===v?"RightBubble":"LeftBubble")},e.nickname===v?r.a.createElement("span",{className:"MsgName"},"Me"):r.a.createElement("span",{className:"MsgName"},e.nickname),r.a.createElement("span",{className:"MsgDate"}," at ",e.date),r.a.createElement("p",null,e.message))))}))),r.a.createElement("footer",{className:"StickyFooter"},r.a.createElement(E.a,{className:"MessageForm",onSubmit:function(e){e.preventDefault();var a=B;a.roomname=S,a.nickname=v,a.date=w()(new Date).format("DD/MM/YYYY HH:mm:ss"),a.type="message",y.database().ref("chats/").push().set(a),M({roomname:"",nickname:"",message:"",date:"",type:""})}},r.a.createElement(U.a,null,r.a.createElement(h.a,{type:"text",name:"message",id:"message",placeholder:"Enter message here",value:B.message,onChange:function(e){e.persist(),M(Object(i.a)(Object(i.a)({},B),{},Object(u.a)({},e.target.name,e.target.value)))}}),r.a.createElement(z.a,{addonType:"append"},r.a.createElement(g.a,{variant:"primary",type:"submit"},"Send")))))))))},P=["children"];var Q=function(){var e=Object(l.h)();return r.a.createElement(s.a,null,r.a.createElement("div",null,r.a.createElement(l.a,{to:{pathname:"/roomlist",state:{from:e}}}),r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/login"},r.a.createElement(O,null)),r.a.createElement(X,{path:"/roomlist"},r.a.createElement(B,null)),r.a.createElement(X,{path:"/addroom"},r.a.createElement(I,null)),r.a.createElement(X,{path:"/chatroom/:room"},r.a.createElement(K,null)))))};function X(e){var a=e.children,t=Object(m.a)(e,P);return r.a.createElement(l.b,Object.assign({},t,{render:function(e){var t=e.location;return localStorage.getItem("nickname")?a:r.a.createElement(l.a,{to:{pathname:"/login",state:{from:t}}})}}))}o.a.render(r.a.createElement(s.a,null,r.a.createElement(Q,null)),document.getElementById("root"))},58:function(e,a,t){e.exports=t(137)},64:function(e,a,t){},65:function(e,a,t){}},[[58,1,2]]]);
//# sourceMappingURL=main.32bc5e5b.chunk.js.map